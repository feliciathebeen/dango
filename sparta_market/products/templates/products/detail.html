{% extends 'base.html' %}
{% block content %}
    {% if article.image %}
        <img src="{{ article.image.url }}" alt="{{ article.title }}" >
    {% endif %}
    <hr>

    <h3>{{ article.title }}</h3>
    <div class="d-flex justify-content-between align-items-center mb-3" style="margin-top : 10px;">
    <p>ì‘ì„±ì¼ì‹œ: {{ article.created_at }}, ìˆ˜ì •ì¼ì‹œ: {{ article.updated_at }}</p>
    <p>ì¡°íšŒìˆ˜: {{ article.view_count }}</p>
    </div>
    <p>{{ article.content }}</p>

    <form action="{% url 'products:like' article.pk %}" method="POST">
        {% csrf_token %}
        <button class="btn btn-light">
            {% if request.user in article.like_users.all %}
                â¤ï¸{{ article.like_count }}
            {% else %}
                ğŸ’”{{ article.like_count }}
            {% endif %}
        </button>
        
    </form>
    <hr>
    

    {% if user == article.author %}
        <a href="{% url 'products:update' article.pk %}" class="btn btn-primary me-2">ìˆ˜ì •</a>
        <form action="{% url 'products:delete' article.pk %}" method="POST" class="d-inline">
            {% csrf_token %}
            <input type="submit" value="ì‚­ì œ" class="btn btn-danger me-2">
        </form>
    {% endif %}

    <a href="{% url 'products:home' %}" class="btn btn-secondary">ëª©ë¡</a>

    {% if request.user.is_authenticated %}
    <br>
    <hr>
    <h3>ëŒ“ê¸€ {{ comments|length }}ê°œ</h3>
    <form action="{% url "products:comment_create" article.pk %}" method="POST">
        {% csrf_token %}
        {{ comment_form.as_p }}
        <input type="submit" value="ëŒ“ê¸€ì‘ì„±">
    </form>
    {% endif %}

    {% for comment in comments %}
    <ul>
        <li>{{ comment.content }} - {{ comment.user.username }}</li>

        {% if user == comment.user %}
        <form action="{% url "products:comment_delete" article.pk comment.pk%}" method="POST">
            {% csrf_token %}
            <input type="submit" value="ì‚­ì œ">
        </form>
        {% endif %}

    </ul>

    {% empty %}
    <p>ëŒ“ê¸€ì´ ì—†ìŠµë‹ˆë‹¤.</p>

    {% endfor %}
    <a href="{% url 'products:home' %}">ëª©ë¡ ë³´ê¸°</a>

{% endblock content %}